Option Explicit
Public Sub test1111()
'
  Dim rng As Range
  Dim lookFor As Range
  Dim table_array As Range
  Dim table_array_col As Integer
  Dim howMany As Long
  Dim i As Long
  
  Dim progID As String
  Dim topic1 As String
  Dim stockcode As String
  
  'Dim bizday As Range
  Dim request As Range
  Dim tDate As Range
  Dim num As Integer

  
  Set rng = Range("A2:A" & Cells(Rows.Count, 1).End(xlUp).Row)
  Set lookFor = Range([A2], Cells(Rows.Count, "A").End(xlUp))
  Set table_array = Worksheets("KR코드").Range("A5:C2273")
  table_array_col = 3
  rng.Offset(, 3) = Application.VLookup(lookFor.Value, table_array, table_array_col, 0)
  
  howMany = WorksheetFunction.CountA(Range("A2:A10"))
  Cells(2, "I") = howMany

  For i = 0 To howMany
    Worksheets("test").Cells(1, 2 + 11 * i) = Cells(2 + i, "C")
    Next i
  
  num = 0
  'Set bizday = Cells(8, "G")
  Set request = Cells(2, "G")
  Set tDate = Cells(8 + num, "H")
  'Set lastCell = Cells(Rows.Count, "H").End(xlUp)

  progID = "mpmaster.rtds"
  stockcode = "005930"
  topic1 = stockcode + ".KR!TradingDate?"

  Do
    'Set bizday = Cells(8 + num, "G")
    'bizday.Value = num
    Set tDate = Cells(8 + num, "H")
    tDate.Formula = "=RTD(""mpmaster.rtds"",," & Chr(34) & topic1 & Chr(34) & "&" & num & ")" '
    num = num + 1
  Loop While num < request.Value
  
    
End Sub
